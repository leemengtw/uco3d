missing_meta_files = [
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/art_and_craft_supplies/coloring_material/45-67927-60373/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/art_and_craft_supplies/thread/418-53378-89327/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/audio_and_video_equipment/amplifier/85-42177-21763/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/audio_and_video_equipment/speaker_stero_equipment/1-41564-14495/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/audio_and_video_equipment/whistle/252-19842-66360/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/baby_and_toddler_items/diaper/326-88084-26003/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/baby_and_toddler_items/pacifier/47-30178-32557/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/bags_and_luggage/handbag/270-57202-46807/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/bags_and_luggage/wallet/244-51949-60361/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/bags_and_luggage/wallet/369-34094-34219/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/bags_and_luggage/wallet/819-80638-47399/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/bakery_and_confectionery/bread/64-32765-88969/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/bakery_and_confectionery/bun/271-45836-32179/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/bakery_and_confectionery/chocolate_bar/22-90523-89266/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/bakery_and_confectionery/chocolate_bar/27-16976-46784/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/bakery_and_confectionery/cookie/188-56247-69436/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/bakery_and_confectionery/cookie/24-67093-72026/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/bakery_and_confectionery/lollipop/547-66543-44676/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/bakery_and_confectionery/muffin/44-45444-50833/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/bakery_and_confectionery/muffin/45-3494-43539/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/bakery_and_confectionery/waffle/2-31101-656/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/bathroom_items/toilet/22235-36472-49522/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/beauty_and_grooming/shampoo/226-80640-68498/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/beverages/alcohol/101-65402-7315/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/beverages/alcohol/27-15266-14974/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/beverages/beer_can/32-77575-50854/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/clothing_accessories/barrette/279-15511-89648/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/clothing_accessories/barrette/356-95500-9950/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/clothing_accessories/headband/103-52327-9096/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/clothing_accessories/headband/91-78763-21494/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/computers_and_peripherals/mouse_computer_equipment/9799-901-2047/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/condiments_and_snacks/jam/19-67844-39129/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/condiments_and_snacks/olive_oil/155-3955-28092/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/containers_and_storage/bottle/919-93665-51992/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/containers_and_storage/box/273-73219-61700/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/containers_and_storage/jar/195-26222-25164/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/containers_and_storage/jar/212-81644-15319/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/containers_and_storage/jar/262-86964-41662/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/containers_and_storage/water_bottle/820-48787-79887/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/containers_and_storage/water_bottle/91-52651-5477/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/decorative_items/vase/87-10208-48843/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/dishware_and_serving_pieces/bowl/298-45696-40520/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/dishware_and_serving_pieces/bowl/685-54049-90869/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/dishware_and_serving_pieces/dixie_cup/322-29455-91513/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/dishware_and_serving_pieces/glass_drink_container/1-48895-70775/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/dishware_and_serving_pieces/glass_drink_container/1-54965-46900/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/dishware_and_serving_pieces/mug/599-60912-94385/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/dishware_and_serving_pieces/mug/618-64586-29742/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/dishware_and_serving_pieces/sugar_bowl/22-93517-70328/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/footwear/shoe/47629-62121-27020/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/fruit/apple/458-97765-33211/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/fruit/apple/676-17608-19459/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/fruit/banana/440-15884-83576/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/fruit/banana/672-88813-33428/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/fruit/banana/957-15594-31040/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/fruit/banana/980-90002-51869/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/fruit/banana/998-82718-46249/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/fruit/coconut/685-78907-1407/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/fruit/lemon/412-34534-14765/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/fruit/lemon/613-11058-92952/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/fruit/lemon/780-48297-16527/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/fruit/lemon/994-22161-18353/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/fruit/sweet_potato/68-52949-77076/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/furniture/chair/60372-34682-22703/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/furniture/chair/648-73890-52510/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/furniture/chair/77-50403-89390/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/furniture/folding_chair/2-57661-64075/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/furniture/stool/727-22777-98685/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/general_animals/goat/69-26774-69623/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/hardware_tools/toolbox/36-26377-28631/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/hardware_tools/wall_socket/129-55752-66097/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/household_appliances/curling_iron/40-48430-61834/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/household_appliances/iron_for_clothing/1-46628-83569/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/household_appliances/iron_for_clothing/1-87083-94791/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/kitchen_appliances/cooker/332-73843-29676/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/kitchen_appliances/crock_pot/12-69704-40950/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/kitchen_appliances/kettle/112-15477-39749/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/kitchen_appliances/mixer_kitchen_tool/1-80839-88537/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/kitchen_appliances/toaster_oven/9-98164-19678/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/kitchen_utensils_and_cookware/fork/261-20981-21096/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/kitchen_utensils_and_cookware/frying_pan/23-66291-86174/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/kitchen_utensils_and_cookware/pot/61-55655-21363/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/kitchen_utensils_and_cookware/reamer_juicer/1-15819-10135/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/kitchen_utensils_and_cookware/reamer_juicer/1-23640-73483/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/kitchen_utensils_and_cookware/spoon/175-88403-31590/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/kitchen_utensils_and_cookware/spoon/295-98737-59762/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/kitchen_utensils_and_cookware/spoon/399-16729-62590/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/kitchen_utensils_and_cookware/spoon/490-63853-10371/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/kitchen_utensils_and_cookware/spoon/706-91394-6225/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/kitchen_utensils_and_cookware/spoon/822-45095-45133/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/kitchen_utensils_and_cookware/strainer/166-27962-46022/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/lighting_equipment/lightbulb/268-6340-57516/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/meal/bagel/7-3153-10904/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/meal/boiled_egg/98-59142-79351/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/meal/egg/270-95312-96646/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/meal/egg/4-44332-2300/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/medical_supplies_and_equipment/dropper/200-75060-58521/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/medical_supplies_and_equipment/dropper/24-40852-99164/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/medical_supplies_and_equipment/ice_pack/16-95323-73668/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/medical_supplies_and_equipment/sling_bandage/1-41035-27122/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/musical_instruments/drumstick/134-3699-26731/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/musical_instruments/drumstick/33-12097-4248/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/office_and_school_supplies/eraser/384-62419-8422/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/office_and_school_supplies/eraser/413-12316-24082/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/office_and_school_supplies/eraser/6-28660-52114/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/personal_hygiene_products/lip_balm/221-26622-16173/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/personal_hygiene_products/lip_balm/436-38963-71480/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/personal_hygiene_products/soap/304-83511-95642/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/personal_hygiene_products/soap/352-95001-26663/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/personal_hygiene_products/toothbrush/380-29023-57505/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/personal_hygiene_products/toothpaste/725-60548-37140/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/personal_hygiene_products/toothpaste/757-89945-74561/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/personal_items/dress_hat/17-42854-77402/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/personal_items/hairnet/61-88822-72422/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/personal_items/matchbox/245-56797-29746/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/personal_items/matchbox/50-96360-98696/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/personal_items/passport/4-3015-88742/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/pets_most_friendly_to_humans/dog/11889-29927-26413/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/pets_most_friendly_to_humans/dog/924-74417-43024/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/stationery/sculpture/235-54313-30276/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/stationery/sculpture/296-46119-70475/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/stationery/tassel/102-64738-83205/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/street_building_and_construction/stop_sign/10760-59143-954/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/street_building_and_construction/stop_sign/26396-1911-42948/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/tools/pliers/279-9513-26135/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/tools/pliers/77-47715-14903/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/tools/step_stool/7-53771-3462/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/toys_and_games/balloon/285-30973-2731/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/toys_and_games/balloon/58-18503-23476/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/toys_and_games/cover/24-67216-78606/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/toys_and_games/doll/192-27175-18654/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/toys_and_games/lego/55-402-67132/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/toys_and_games/slide/14-14438-30969/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/toys_and_games/teddy_bear/378-88283-86110/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/toys_and_games/teddy_bear/513-7515-41952/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/vegetables_and_legumes/carrot/113-78849-70717/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/vegetables_and_legumes/carrot/203-21823-62295/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/vegetables_and_legumes/carrot/483-59149-87693/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/vegetables_and_legumes/carrot/547-10830-63834/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/vegetables_and_legumes/chickpea/15-84918-59695/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/vegetables_and_legumes/garlic/190-1431-8991/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/vegetables_and_legumes/onion/156-85999-19740/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/vegetables_and_legumes/onion/607-74247-22774/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/vegetables_and_legumes/onion/925-32233-40897/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/vegetables_and_legumes/zucchini/32-37236-21889/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/water_vehicles_and_aircraft/airplane/179-58825-70107/gaussian_splats/meta.json",
    "/fsx-repligen/shared/datasets/uCO3D/dataset_export/water_vehicles_and_aircraft/helicopter/115-33765-91233/gaussian_splats/meta.json",
]

import os
import shutil
import glob

gaussian_files = [
    "fg_mask.npz",
    "means_l.png",
    "means_u.png",
    "meta.json",
    "opacities.png",
    "quats.png",
    "scales.png",
    "sh0.png",
    "shN.npz",
]

gaussian_files_no_mask = list(gaussian_files[1:])


scenes_with_broken_splats = []
for meta_file in missing_meta_files:
    # print(meta_file)

    break  # a safeguard

    gaussian_dir_correct = os.path.dirname(meta_file)
    scene_name = os.path.basename(os.path.dirname(gaussian_dir_correct))
    wrong_dir_to_rm = os.path.join(gaussian_dir_correct, scene_name)
    if all(
        os.path.exists(os.path.join(gaussian_dir_correct, fl))
        for fl in gaussian_files_no_mask
    ):
        assert not os.path.exists(wrong_dir_to_rm)
        print(f"Scene {scene_name} has all the correct splat files.")
        continue

    assert not os.path.isfile(meta_file), meta_file

    gaussian_dir_wrong = os.path.join(gaussian_dir_correct, scene_name, "compressed")

    if not os.path.exists(gaussian_dir_wrong):
        # print(f"Folder {gaussian_dir_wrong} does not exist!")
        scenes_with_broken_splats.append(scene_name)
        continue

    can_be_fixed = True
    for fl in gaussian_files:
        gaussian_file_wrong = os.path.join(gaussian_dir_wrong, fl)
        gaussian_file_correct = os.path.join(gaussian_dir_correct, fl)
        assert not os.path.isfile(gaussian_file_correct)
        if not os.path.isfile(gaussian_file_wrong) and fl != "fg_mask.npz":
            can_be_fixed = False
            break
            print(f"File {gaussian_file_wrong} does not exist!")

    if not can_be_fixed:
        print(f"Scene {scene_name} has a broken splat folder.")
        continue

    for fl in gaussian_files:
        gaussian_file_wrong = os.path.join(gaussian_dir_wrong, fl)
        gaussian_file_correct = os.path.join(gaussian_dir_correct, fl)
        if os.path.isfile(gaussian_file_wrong):
            print(f"{gaussian_file_wrong}\n  ---> {gaussian_file_correct}")
            shutil.move(gaussian_file_wrong, gaussian_file_correct)

    existing_wrong_files = glob.glob(os.path.join(gaussian_dir_wrong, "*"))
    print("Existing wrong files:")
    print(existing_wrong_files)
    print(f"rmtree: {wrong_dir_to_rm}")
    assert len(existing_wrong_files) == 0
    shutil.rmtree(wrong_dir_to_rm)

# print("scenes_with_broken_splats:")
# for scene in scenes_with_broken_splats:
#     print(scene)

# dataset_root = "/fsx-repligen/shared/datasets/uCO3D/dataset_export/"
# scene_dirs = glob.glob()
# for folder in bad_folders:
#     for
